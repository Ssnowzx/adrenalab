<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game of Skate - Cadastro</title>
    <!-- Tailwind CSS (Estilos) -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Ícones Lucide -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        body { font-family: sans-serif; }
        .font-impact { font-family: 'Impact', sans-serif; }
        
        /* Utilitários para esconder/mostrar elementos */
        .hidden { display: none !important; }
        
        /* Animação suave de entrada */
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { 
            from { opacity: 0; transform: scale(0.95); } 
            to { opacity: 1; transform: scale(1); } 
        }
    </style>
</head>
<body class="min-h-screen w-full flex items-center justify-center relative overflow-hidden bg-[#2e1a0b]">

    <!-- Camada de Fundo (Background) -->
    <div id="bg-layer" class="absolute inset-0 bg-cover bg-center z-0 transition-all duration-700 bg-[#2e1a0b]">
        <!-- Sobreposição Escura -->
        <div class="absolute inset-0 bg-black/70 backdrop-blur-[2px]"></div>
    </div>

    <!-- Conteúdo Principal -->
    <div class="relative z-10 w-full max-w-md p-6 fade-in">
        


        <!-- Caixa Preta do Formulário -->
        <div class="bg-black border-2 border-orange-600 shadow-[0_0_30px_rgba(234,88,12,0.5)] rounded-2xl p-8">
            
            <!-- Cabeçalho -->
            <div class="text-center mb-8">
                <h1 class="text-4xl font-black text-orange-600 tracking-tighter uppercase drop-shadow-sm mb-2 font-impact">
                    Game of Skate
                </h1>
                <p class="text-orange-500 text-sm font-medium tracking-widest uppercase">
                    Ficha de Inscrição
                </p>
            </div>

            <!-- Formulário -->
            <form id="cadastro-form" class="space-y-6">
                
                <!-- Campo Nome -->
                <div class="space-y-2 group">
                    <label class="text-xs font-bold text-orange-500 uppercase tracking-wider ml-1">
                        Qual teu nome Bruxão?
                    </label>
                    <div class="relative">
                        <div class="absolute left-3 top-1/2 -translate-y-1/2 text-orange-600">
                            <i data-lucide="user" width="20"></i>
                        </div>
                        <input
                            type="text"
                            name="nome"
                            id="input-nome"
                            required
                            placeholder="SEU NOME COMPLETO"
                            class="w-full bg-black border-2 border-orange-800 rounded-xl py-3 pl-10 pr-4 text-orange-400 placeholder-orange-800 focus:outline-none focus:border-orange-500 focus:ring-1 focus:ring-orange-500 transition-all duration-300"
                        />
                    </div>
                </div>

                <!-- Campo Categoria -->
                <div class="space-y-2 group">
                    <label class="text-xs font-bold text-orange-500 uppercase tracking-wider ml-1">
                        MINI ou SOLO meu parceiro?
                    </label>
                    <div class="relative">
                        <div class="absolute left-3 top-1/2 -translate-y-1/2 text-orange-600">
                            <i data-lucide="layers" width="20"></i>
                        </div>
                        <select
                            name="categoria"
                            id="input-categoria"
                            class="w-full bg-black border-2 border-orange-800 rounded-xl py-3 pl-10 pr-10 text-orange-400 appearance-none focus:outline-none focus:border-orange-500 focus:ring-1 focus:ring-orange-500 transition-all duration-300 cursor-pointer hover:bg-orange-900/10"
                        >
                            <option value="Solo">Solo (Dia 06/12) - R$ 10,00</option>
                            <option value="Mini">Mini (Dia 07/12) - R$ 10,00</option>
                            <option value="Solo + Mini">Solo + Mini (Combo) - R$ 20,00</option>
                        </select>
                        <div class="absolute right-3 top-1/2 -translate-y-1/2 text-orange-600 pointer-events-none">
                            <i data-lucide="chevron-down" width="16"></i>
                        </div>
                    </div>
                </div>

                <!-- Botão Enviar -->
                <button
                    type="submit"
                    class="w-full bg-orange-700 hover:bg-orange-600 text-white font-bold py-4 rounded-xl shadow-lg transform transition-all duration-300 hover:scale-[1.02] active:scale-95 mt-4 uppercase tracking-wide border border-orange-500"
                >
                    Confirmar Inscrição
                </button>
            </form>

            <!-- Tela de Sucesso (Inicialmente escondida) -->
            <div id="success-view" class="text-center py-8 hidden fade-in">
                <div class="w-20 h-20 bg-orange-900/20 rounded-full flex items-center justify-center mx-auto mb-4 border border-orange-500 shadow-[0_0_15px_rgba(234,88,12,0.3)]">
                    <i data-lucide="check-circle" width="40" class="text-orange-500"></i>
                </div>
                <h3 class="text-2xl font-bold text-orange-500 mb-2">Falta pouco <span id="display-nome" class="text-orange-300"></span>!</h3>
                
                <div class="bg-orange-900/20 border border-orange-800 rounded-xl p-4 mb-6 relative group">
                    <p class="text-orange-400 mb-2 text-sm uppercase tracking-wider font-bold">Agora é só fazer o pix:</p>
                    <div class="flex items-center justify-between bg-black/50 rounded-lg p-3 border border-orange-900/50 mb-4">
                        <code id="pix-key" class="text-orange-200 font-mono text-sm break-all">adrenaskateboard@gmail.com</code>
                        <button id="btn-copy" class="ml-2 text-orange-500 hover:text-orange-300 transition-colors p-2 rounded hover:bg-orange-900/30" title="Copiar Chave Pix">
                            <i data-lucide="copy" width="18"></i>
                        </button>
                    </div>

                    <p class="text-orange-300 text-xs mb-3 font-medium text-center">
                        Após efetuar o pagamento, mande o comprovante para garantir a sua vaga.
                    </p>

                    <a href="https://wa.me/5549999464190" target="_blank" class="block w-full bg-green-600/20 hover:bg-green-600/30 border border-green-500/50 text-green-400 hover:text-green-300 text-center font-bold py-3 rounded-lg transition-all flex items-center justify-center gap-2 text-sm uppercase tracking-wide">
                        <i data-lucide="message-circle" width="18"></i>
                        Mande o comprovante aqui!
                    </a>
                    <div id="copy-feedback" class="absolute -bottom-8 left-1/2 -translate-x-1/2 text-xs text-green-400 font-bold opacity-0 transition-opacity duration-300">
                        Copiado!
                    </div>
                </div>
                
                <div class="bg-black rounded-lg p-4 border border-orange-600 mb-6">
                    <p id="display-message" class="text-xs text-orange-500 uppercase tracking-widest mb-1"></p>
                    <p id="display-categoria" class="text-xl font-bold text-orange-400 mb-2"></p>
                    <div class="inline-block bg-orange-900/40 border border-orange-500/50 rounded px-3 py-1">
                        <span class="text-xs text-orange-500 mr-1">Valor:</span>
                        <span id="display-price" class="text-lg font-bold text-white"></span>
                    </div>
                </div>

                <button id="btn-novo" class="text-sm text-orange-600 hover:text-orange-400 underline underline-offset-4 transition-colors">
                    Fazer nova inscrição
                </button>


            </div>

        </div>
    </div>

    <!-- Script (Lógica) -->
    <script>
        // 1. Renderiza os ícones
        lucide.createIcons();

        // 2. Lógica da Imagem de Fundo
        const bgLayer = document.getElementById('bg-layer');
        
        // Define a imagem fixa de fundo
        bgLayer.style.backgroundImage = `url('puplic/Patrocínio (3).png')`;

        // 3. Lógica do Formulário
        const form = document.getElementById('cadastro-form');
        const successView = document.getElementById('success-view');
        const displayNome = document.getElementById('display-nome');
        const displayCategoria = document.getElementById('display-categoria');
        const displayMessage = document.getElementById('display-message');
        const displayPrice = document.getElementById('display-price');
        const btnNovo = document.getElementById('btn-novo');

        // Quando clicar em "Confirmar Inscrição"
        form.addEventListener('submit', async (e) => {
            e.preventDefault(); // Impede recarregamento da página
            
            // Pega os valores digitados
            const nome = document.getElementById('input-nome').value;
            const categoria = document.getElementById('input-categoria').value;

            try {
                const response = await fetch('/api/register', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ nome, categoria })
                });

                if (response.ok) {
                    displayNome.textContent = nome;
                    
                    // Lógica de Mensagem e Preço
                    let message = '';
                    let price = '';

                    if (categoria === 'Solo + Mini') {
                        message = 'Ai sim Bruxão';
                        price = 'R$ 20,00';
                    } else {
                        message = 'Você escolheu';
                        price = 'R$ 10,00';
                    }

                    displayMessage.textContent = message;
                    displayCategoria.textContent = categoria;
                    displayPrice.textContent = price;
                    
                    // Troca as telas
                    form.classList.add('hidden');
                    successView.classList.remove('hidden');
                } else {
                    alert('Erro ao realizar inscrição. Tente novamente.');
                }
            } catch (error) {
                console.error('Erro:', error);
                alert('Erro ao conectar com o servidor. Verifique se o backend está rodando.');
            }
        });

        // Quando clicar em "Fazer nova inscrição"
        btnNovo.addEventListener('click', () => {
            document.getElementById('input-nome').value = '';
            document.getElementById('input-categoria').value = 'Solo';
            
            successView.classList.add('hidden');
            form.classList.remove('hidden');
        });

        // 4. Lógica do Pix
        const btnCopy = document.getElementById('btn-copy');
        const pixKey = document.getElementById('pix-key');
        const copyFeedback = document.getElementById('copy-feedback');

        if (btnCopy) {
            btnCopy.addEventListener('click', () => {
                const textToCopy = pixKey.textContent;
                navigator.clipboard.writeText(textToCopy).then(() => {
                    // Feedback visual
                    copyFeedback.style.opacity = '1';
                    setTimeout(() => {
                        copyFeedback.style.opacity = '0';
                    }, 2000);
                }).catch(err => {
                    console.error('Erro ao copiar: ', err);
                });
            });
        }
    </script>
</body>
</html>